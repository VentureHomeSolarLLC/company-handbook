<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizing the Agora: The Pivot Point Workflow</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
    </script>
    <style>
        :root {
            --bg-color: #F3F3EA;
            --text-color: #231F20;
            --primary-color: #059669;
            --accent-yellow: #F7FF96;
            --border-color: #B1C3BD;
            --header-border-color: #231F20;
            --code-bg: #231F20;
            --code-text: #F3F3EA;
            --table-header-bg: #e9e9e1;
            --table-border: #B1C3BD;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.7;
            color: var(--text-color);
            background: var(--bg-color);
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        .header {
            text-align: center;
            border-bottom: 2px solid var(--header-border-color);
            padding-bottom: 1.5rem;
            margin-bottom: 3rem;
        }
        .header h1 { 
            font-family: 'SF Mono', 'Menlo', 'Monaco', monospace;
            font-size: 2.5rem; 
            margin-bottom: 0.5rem; 
            font-weight: 700;
            color: var(--text-color);
        }
        .header .subtitle { color: #555; font-size: 1.1rem; }
        .section { margin-bottom: 4rem; }
        h2 { 
            font-family: 'SF Mono', 'Menlo', 'Monaco', monospace;
            font-size: 1.8rem; 
            font-weight: 700; 
            margin-bottom: 1.5rem; 
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .scenario-box {
            background: #fff;
            border: 2px solid var(--primary-color);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        .scenario-title { font-weight: 700; color: var(--primary-color); margin-bottom: 0.5rem; font-family: 'SF Mono', monospace; }
        .mermaid { margin: 2rem 0; text-align: center; }
        
        /* Agent Brain State Table */
        .brain-state {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .brain-state th { background: #231F20; color: #fff; text-align: left; padding: 1rem; }
        .brain-state td { padding: 1rem; border-bottom: 1px solid #eee; vertical-align: top; }
        .brain-state tr:last-child td { border-bottom: none; }
        .step-col { width: 15%; font-weight: bold; font-family: 'SF Mono', monospace; }
        .action-col { width: 35%; }
        .pivot-col { width: 50%; background: #f9fafb; color: #4b5563; font-size: 0.95em; }
        .file-tag {
            display: inline-block;
            background: rgba(122, 239, 177, 0.4);
            padding: 0.2em 0.5em;
            border-radius: 4px;
            font-family: 'SF Mono', monospace;
            font-size: 0.85em;
            color: #065f46;
            margin-bottom: 0.5em;
        }
        .rule-highlight {
            border-left: 3px solid var(--primary-color);
            padding-left: 0.8rem;
            margin-top: 0.5rem;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Visualizing the Agora: Part 4</h1>
        <div class="subtitle">The Pivot Point Workflow: A "ConEd + Sunnova" Example</div>
    </div>

    <div class="section">
        <h2>1. The Scenario</h2>
        <p>This diagram shows exactly how an agent navigates a complex task by combining a <strong>Universal Skill</strong> with specific <strong>Concept Data</strong>. The agent does not memorize 100 permutations; it looks up the rules it needs <em>at the exact moment it needs them</em>.</p>
        
        <div class="scenario-box">
            <div class="scenario-title">INCOMING TASK</div>
            <p><strong>Task:</strong> Submit Interconnection Application for Project #12345</p>
            <p><strong>Utility:</strong> Con Edison (ConEd)</p>
            <p><strong>Financing:</strong> Sunnova</p>
        </div>
    </div>

    <div class="section">
        <h2>2. The Agent's Path (Visualized)</h2>
        <div class="mermaid">
            graph TD
            %% Styles
            classDef start fill:#231F20,color:#fff,stroke:#231F20,stroke-width:2px;
            classDef skill fill:#fff,stroke:#231F20,stroke-width:2px;
            classDef pivot fill:#F7FF96,stroke:#d97706,stroke-width:2px,stroke-dasharray: 5 5;
            classDef endstate fill:#059669,color:#fff,stroke:#059669;

            Start((START)):::start --> Load[Load Engram: interconnection-submissions]:::skill
            Load --> Step1[Step 1: Login to Utility Portal]:::skill
            Step1 --> Step2[Step 2: Upload Line Diagram]:::skill
            
            %% PIVOT 1: UTILITY
            Step2 --> Pivot1{STOP & CHECK:<br>What are the<br>Diagram Rules?}:::pivot
            Pivot1 -- Read concepts/utilities/coned.md --> Rule1[Rule Found:<br>Requires 3-Line Diagram<br>Wet Signature]:::skill
            Rule1 --> Action1[Action: Upload 3-Line Diagram]:::skill
            
            Action1 --> Step3[Step 3: Enter Customer Data]:::skill
            
            %% PIVOT 2: FINANCE
            Step3 --> Pivot2{STOP & CHECK:<br>What are the<br>Finance Rules?}:::pivot
            Pivot2 -- Read concepts/finance/sunnova.md --> Rule2[Rule Found:<br>Requires PTO Letter<br>Upload within 24h]:::skill
            Rule2 --> Action2[Action: Queue PTO Letter Task]:::skill
            
            Action2 --> Submit((SUBMIT)):::endstate
        </div>
    </div>

    <div class="section">
        <h2>3. Inside the Agent's Brain (Step-by-Step)</h2>
        <p>This table shows what the agent is "thinking" and which files it is reading at each stage of the process.</p>

        <table class="brain-state">
            <thead>
                <tr>
                    <th>Step</th>
                    <th>Agent Action (The "Hands")</th>
                    <th>The Pivot (The "Brain")</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="step-col">START</td>
                    <td class="action-col">Receives task. Identifies keyword "Interconnection".</td>
                    <td class="pivot-col">
                        <span class="file-tag">Load: engrams/interconnection/_index.md</span><br>
                        "I am loading the Interconnection Engram. The MOC tells me to use the standard submission skill."
                    </td>
                </tr>
                <tr>
                    <td class="step-col">STEP 1</td>
                    <td class="action-col">Logs into the ConEd Portal.</td>
                    <td class="pivot-col">
                        <span class="file-tag">Read: skills/submit-application.md</span><br>
                        "Following standard procedure. Step 1 complete."
                    </td>
                </tr>
                <tr>
                    <td class="step-col">STEP 2</td>
                    <td class="action-col">Prepares to upload the Line Diagram. <strong>Pauses.</strong></td>
                    <td class="pivot-col">
                        <span class="file-tag">Read: concepts/utilities/coned.md</span><br>
                        "Wait. Does this utility want 1-line or 3-line? I am checking the ConEd concept file."
                        <div class="rule-highlight">Rule: ConEd requires 3-Line Diagram.</div>
                    </td>
                </tr>
                <tr>
                    <td class="step-col">ACTION</td>
                    <td class="action-col"><strong>Selects the "3-Line Diagram" file</strong> and uploads it.</td>
                    <td class="pivot-col">
                        "Applying the rule. If this were PSEG, I would have selected the 1-Line."
                    </td>
                </tr>
                <tr>
                    <td class="step-col">STEP 3</td>
                    <td class="action-col">Fills out customer details. <strong>Pauses.</strong></td>
                    <td class="pivot-col">
                        <span class="file-tag">Read: concepts/finance/sunnova.md</span><br>
                        "Wait. Does this finance partner have extra compliance steps? Checking Sunnova concept file."
                        <div class="rule-highlight">Rule: Sunnova requires PTO Letter upload.</div>
                    </td>
                </tr>
                <tr>
                    <td class="step-col">FINISH</td>
                    <td class="action-col">Submits application. Creates a follow-up task for the PTO letter.</td>
                    <td class="pivot-col">
                        "Task complete. All constraints satisfied."
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

</body>
</html>
